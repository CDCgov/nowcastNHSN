% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/date_utils.R
\name{cumulative_to_incremental}
\alias{cumulative_to_incremental}
\title{Convert cumulative counts to incremental counts}
\usage{
cumulative_to_incremental(data, group_cols = c("reference_date", "location"))
}
\arguments{
\item{data}{A data frame with columns \code{reference_date}, \code{report_date}, and
\code{count}. The \code{count} column should contain cumulative counts.}

\item{group_cols}{Character vector of additional columns to group by when
computing differences (e.g., "location", "signal"). Default is
\code{c("reference_date", "location")}.}
}
\value{
A data frame with the same structure as input, but with \code{count}
converted to incremental counts (difference from previous report date).
}
\description{
Converts cumulative counts (total reported as of each report date) to
incremental counts (new cases reported at each report date). This is
necessary because some data sources (e.g., epidatr NHSN data) return
cumulative counts, but \code{baselinenowcast::as_reporting_triangle()} expects
incremental counts.
}
\details{
For each reference date (and optionally other grouping columns), the
function:
\enumerate{
\item Sorts by report date
\item Computes the difference from the previous report date's count
\item Uses 0 as the "previous" count for the first report date
}

This assumes that the first report date for each reference date represents
the initial count (i.e., there was 0 before it).
}
\examples{
# Example with cumulative data
cumulative_data <- data.frame(
  reference_date = as.Date(c("2024-01-06", "2024-01-06", "2024-01-06")),
  report_date = as.Date(c("2024-01-13", "2024-01-20", "2024-01-27")),
  count = c(100, 120, 125),  # cumulative
  location = "ca"
)

incremental_data <- cumulative_to_incremental(cumulative_data)
# count is now: 100, 20, 5 (the differences)
}
