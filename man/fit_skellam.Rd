% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_methods.R
\name{fit_skellam}
\alias{fit_skellam}
\title{Fit a Skellam distribution with fixed mean to estimate variance}
\usage{
fit_skellam(x, mu, method = "mle")
}
\arguments{
\item{x}{Vector of observed integer values (can be negative).}

\item{mu}{Vector of expected values (fixed means).}

\item{method}{Either "mle" for maximum likelihood estimation or "mom" for
method of moments. Default is "mle".}
}
\value{
The estimated variance (σ² = λ₁ + λ₂).
}
\description{
Takes in a vector of integer observations and a vector of fixed means
(predictions) and estimates the Skellam distribution variance parameter.
The Skellam distribution models the difference of two Poisson random
variables, making it suitable for count differences that can be negative.

With fixed mean μ = λ₁ - λ₂, the variance σ² = λ₁ + λ₂ is estimated via
MLE or method of moments. The Poisson rate parameters can be recovered as:
\itemize{
\item λ₁ = (μ + σ²) / 2
\item λ₂ = (σ² - μ) / 2
}

For valid parameters, we require σ² > |μ|.
}
\examples{
# Differences can be negative
obs <- c(-2, 1, 3, 0, -1)
pred <- c(-1.5, 0.8, 2.5, 0.2, -0.5)
variance <- fit_skellam(obs, pred)
variance

# To sample from Skellam with a new mean prediction:
mu_new <- 5
lambda1 <- 0.5 * (mu_new + variance)
lambda2 <- 0.5 * (variance - mu_new)
# samples <- rpois(n, lambda1) - rpois(n, lambda2)
}
\seealso{
Other estimate_observation_error:
\code{\link{fit_normal}()}
}
\concept{estimate_observation_error}
\concept{probabilistic_methods}
